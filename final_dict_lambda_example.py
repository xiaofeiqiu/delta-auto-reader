#!/usr/bin/env python3
"""
æœ€ç»ˆçš„å­—å…¸ Lambda ä½¿ç”¨ç¤ºä¾‹
Final Dictionary Lambda Usage Example
"""

print("=" * 80)
print("ğŸ¯ æœ€ç»ˆå®ç°ï¼šå­—å…¸ Lambda å˜æ¢å‡½æ•°")
print("ğŸ¯ Final Implementation: Dictionary Lambda Transform Functions")
print("=" * 80)

print("ç°åœ¨ä½ å¯ä»¥è¿™æ ·ä½¿ç”¨å˜æ¢å‡½æ•°:")
print("Now you can use transform functions like this:")
print()

print("# æ–¹å¼ 1: ç›´æ¥ä½¿ç”¨å­—å…¸")
print("# Method 1: Direct dictionary usage")
print("from feature_store_sdk.projection import TRANSFORM_LAMBDAS")
print()
print('transforms = {')
print('    "year": lambda col: TRANSFORM_LAMBDAS["year"](col),')
print('    "month": lambda col: TRANSFORM_LAMBDAS["month"](col),')
print('    "day": lambda col: TRANSFORM_LAMBDAS["day"](col),')
print('    "upper": lambda col: TRANSFORM_LAMBDAS["upper"](col),')
print('    "lpad": lambda col, length, pad="0": TRANSFORM_LAMBDAS["lpad"](col, length, pad),')
print('    "nullif": lambda col, value: TRANSFORM_LAMBDAS["nullif"](col, value),')
print('    "coalesce": lambda *cols: TRANSFORM_LAMBDAS["coalesce"](*cols)')
print('}')
print()

print("# ä½¿ç”¨ç¤ºä¾‹:")
print("# Usage examples:")
print('my_transforms = [')
print('    transforms["year"]("transaction_date"),')
print('    transforms["upper"]("customer_name"),') 
print('    transforms["lpad"]("account_id", 8, "0"),')
print('    transforms["nullif"]("status", "inactive"),')
print('    transforms["coalesce"]("email1", "email2", "emergency_email")')
print(']')
print()

print("=" * 80)
print("# æ–¹å¼ 2: æ›´ç®€æ´çš„å­—å…¸å®šä¹‰")
print("# Method 2: More concise dictionary definition")
print("=" * 80)

print("# ç›´æ¥å¼•ç”¨")
print("# Direct reference")
print("from feature_store_sdk.projection import TRANSFORM_LAMBDAS as T")
print()
print("transforms = {")
print('    "year": T["year"],')
print('    "month": T["month"],')
print('    "day": T["day"],')
print('    "upper": T["upper"],')
print('    "lpad": T["lpad"],')
print('    "nullif": T["nullif"],')
print('    "coalesce": T["coalesce"]')
print("}")
print()

print("# ä½¿ç”¨:")
print("# Usage:")
print('year_transform = transforms["year"]("date_column")')
print('upper_transform = transforms["upper"]("text_column")')
print('lpad_transform = transforms["lpad"]("id_column", 10, "0")')
print()

print("=" * 80)
print("# æ–¹å¼ 3: é…ç½®é©±åŠ¨")
print("# Method 3: Configuration-driven")
print("=" * 80)

print("# é…ç½®æ–‡ä»¶æ ¼å¼")
print("# Configuration file format")
print("transform_config = [")
print('    {"func": "year", "args": ["transaction_date"]},')
print('    {"func": "upper", "args": ["customer_name"]},')
print('    {"func": "lpad", "args": ["account_id", 8, "0"]},')
print('    {"func": "nullif", "args": ["status", "inactive"]},')
print('    {"func": "coalesce", "args": ["email1", "email2", "email3"]}')
print("]")
print()

print("# åŠ¨æ€åˆ›å»ºå˜æ¢")
print("# Dynamic transform creation")
print("from feature_store_sdk.projection import TRANSFORM_LAMBDAS")
print()
print("def create_transforms_from_config(config):")
print("    return [")
print("        TRANSFORM_LAMBDAS[item['func']](*item['args'])")
print("        for item in config")
print("    ]")
print()
print("my_transforms = create_transforms_from_config(transform_config)")
print()

print("=" * 80)
print("# æ–¹å¼ 4: æœ€ç®€åŒ–ç‰ˆæœ¬")
print("# Method 4: Ultra-simplified version")
print("=" * 80)

print("# ä½ æƒ³è¦çš„æ ¼å¼:")
print("# The format you wanted:")
print("from feature_store_sdk.projection import TRANSFORM_LAMBDAS")
print()
print("# é‡å‘½åä¸ºæ›´çŸ­çš„å˜é‡å")
print("# Rename to shorter variable")
print("transforms = TRANSFORM_LAMBDAS")
print()
print("# ç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨:")
print("# Now you can use directly:")
print('year_func = transforms["year"]')
print('upper_func = transforms["upper"]')
print('lpad_func = transforms["lpad"]')
print()
print("# åˆ›å»ºå˜æ¢:")
print("# Create transforms:")
print('my_transforms = [')
print('    year_func("date_col"),')
print('    upper_func("text_col"),')
print('    lpad_func("id_col", 8, "0")')
print(']')
print()

print("=" * 80)
print("ğŸ‰ æ€»ç»“ Summary")
print("=" * 80)
print("âœ… å®ç°äº† 7 ä¸ªé‡æ–°å®šä¹‰çš„å‡½æ•°:")
print("   YEAR, MONTH, DAY, LPAD, NULLIF, UPPER, COALESCE")
print()
print("âœ… æä¾›äº† 5 ç§ä¸åŒçš„ä½¿ç”¨æ–¹å¼:")
print("   1. å¸¸è§„å‡½æ•°: YEAR('date_col')")
print("   2. å‡½æ•°æ˜ å°„: create_transform('YEAR', 'date_col')")
print("   3. Lambda å‡½æ•°: year_lambda('date_col')")
print("   4. è¶…ç®€æ´: year('date_col')")
print("   5. å­—å…¸ Lambda: TRANSFORM_LAMBDAS['year']('date_col') â­")
print()
print("âœ… å­—å…¸ Lambda çš„ä¼˜åŠ¿:")
print("   â€¢ æ‰€æœ‰å‡½æ•°é›†ä¸­åœ¨ä¸€ä¸ªå­—å…¸ä¸­")
print("   â€¢ æ”¯æŒåŠ¨æ€å‡½æ•°è°ƒç”¨")
print("   â€¢ é…ç½®é©±åŠ¨çš„å˜æ¢åˆ›å»º")
print("   â€¢ ä»£ç æå…¶ç®€æ´")
print("   â€¢ æ˜“äºæ‰©å±•å’Œç»´æŠ¤")
print()
print("ğŸ¯ ç°åœ¨ç”¨æˆ·åªéœ€è¦è¾“å…¥å‡½æ•°åå’Œå‚æ•°å³å¯!")
print("ğŸ¯ Now users just need to input function name and parameters!")
print()
print('ç¤ºä¾‹: transforms["year"]("date_col")')
print('ç¤ºä¾‹: transforms["lpad"]("text_col", 10, "0")')
print('ç¤ºä¾‹: transforms["coalesce"]("col1", "col2", "col3")')
print()
print("ğŸš€ å®ç°å®Œæˆï¼Perfect implementation!")